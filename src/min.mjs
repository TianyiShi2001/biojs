export const AMINO_ACID_DATA={ALL:"ACDEFGHIKLMNOPQRSTUVWY",ATTR:{basic:"HKR",acidic:"CDEY",sulfur:"CM",aromatic:"PWY"},NAME:{A:["ala","alanine"],C:["cys","cysteine"],D:["asp","aspartate"],E:["glu","glutamate"],F:["phe","phenylalanine"],G:["gly","glycine"],H:["his","histidine"],I:["ile","isoleucine"],K:["lys","lysine"],L:["leu","leucine"],M:["met","methionine"],O:["orn","ornithine"],P:["pro","proline"],Q:["gln","glutamine"],R:["arg","arginine"],S:["ser","serine"],T:["thr","threonine"],U:["sec","selenocysteine"],V:["val","valine"],W:["phe","phenylalanine"],Y:["tyr","tyrosine"]},MOLECULAR_WEIGHT:{A:[71.0779,71.037113],C:[103.1429,103.009184],D:[115.0874,115.026943],E:[129.114,129.042593],F:[147.1738,147.068414],G:[57.0513,57.021463],H:[137.1393,137.058912],I:[113.1576,113.084064],K:[128.1723,128.094963],L:[113.1576,113.084064],M:[131.196,131.040484],N:[114.1026,114.042927],O:[237.2981,237.147727],P:[97.1152,97.052764],Q:[128.1292,128.058577],R:[156.1857,156.101111],S:[87.0773,87.032028],T:[101.1039,101.047678],U:[150.0379,150.953638],V:[99.131,99.068414],W:[186.2099,186.079313],Y:[163.1732,163.063325],water:[18.0153,18.010565]},MOLECULAR_WEIGHT_1:{A:[89.0932,89.047678],C:[121.1582,121.019749],D:[133.1027,133.037508],E:[147.1293,147.053158],F:[165.1891,165.078979],G:[75.0666,75.032028],H:[155.1546,155.069477],I:[131.1729,131.094629],K:[146.1876,146.105528],L:[131.1729,131.094629],M:[149.2113,149.051049],N:[132.1179,132.053492],O:[255.3134,255.158292],P:[115.1305,115.063329],Q:[146.1445,146.069142],R:[174.201,174.111676],S:[105.0926,105.042593],T:[119.1192,119.058243],U:[168.0532,168.964203],V:[117.1463,117.078979],W:[204.2252,204.089878],Y:[181.1885,181.07389],water:[18.0153,18.010565]},CHARGE:{POSITIVE_PKAS:{Nterm:7.5,K:10,R:12,H:5.98},NEGATIVE_PKAS:{Cterm:3.55,D:4.05,E:4.45,C:9,Y:10},PKA_C_TERMINAL:{D:4.55,E:4.75},PKA_N_TERMINAL:{A:7.59,M:7,S:6.93,P:8.36,T:6.82,V:7.44,E:7.7},CHARGED_AMINO_ACIDS:["K","R","H","D","E","C","Y"]},ATOMIC_COMPOSITION:{A:{C:3,H:7,N:1,O:2},C:{C:3,H:7,N:1,O:2,S:1},D:{C:4,H:7,N:1,O:4},E:{C:5,H:9,N:1,O:4},F:{C:9,H:11,N:1,O:2},G:{C:2,H:5,N:1,O:2},H:{C:6,H:9,N:3,O:2},I:{C:6,H:13,N:1,O:2},K:{C:6,H:14,N:2,O:2},L:{C:6,H:13,N:1,O:2},M:{C:5,H:11,N:1,O:2,S:1},N:{C:4,H:8,N:2,O:3},O:{C:5,H:12,N:2,O:2},P:{C:5,H:9,N:1,O:2},Q:{C:5,H:10,N:2,O:3},R:{C:6,H:14,N:4,O:2},S:{C:3,H:7,N:1,O:3},T:{C:4,H:9,N:1,O:3},U:{C:3,H:7,N:1,O:2,Se:1},V:{C:5,H:11,N:1,O:2},W:{C:11,H:12,N:2,O:2},Y:{C:9,H:11,N:1,O:3}},EXTINCTION_COEFFICIENT:{C:125,W:5690,Y:1280}};export class AminoAcidComposition{constructor(seq){this.init();this.count_aa(seq)}init(){for(const a of AMINO_ACID_DATA.ALL){this[a]={};this[a].count=0}}count_aa(seq){for(const a of seq){this[a]["count"]++}for(const a in this){this[a]["content"]=this[a]["count"]/seq.length}}};export class Protein{constructor(seq){this.seq=seq.toUpperCase();this.length=this.seq.length;this.aminoAcidComposition=new AminoAcidComposition(seq);this.positiveCount=this.aminoAcidComposition.R.count+this.aminoAcidComposition.K.count;this.negativeCount=this.aminoAcidComposition.D.count+this.aminoAcidComposition.E.count;this.atomicComposition=compute_atomic_composition(this.aminoAcidComposition);[this.molecularWeight,this.molecularWeightIsoelectric]=compute_molecular_weight(this.aminoAcidComposition);this.isoelectricPoint=compute_isoelectric_point(this.aminoAcidComposition,seq[0],seq[seq.length-1]);this.extinction_coeffient=compute_extinction_coefficient(this.aminoAcidComposition)}};const prot="MISDDDDLPSTRPGSVNEELPETEPEDNDELPETEPESDSDKPTVTSNKTENQVADEDYDSFDDFVPSQTHTASKIPVKNKRAKKCTVESDSSSSDDSDQGDDCEFIPACDETQEVPKIKRGYTLRTRASVKNKCDDSWDDGIDEEDVSKRSEDTLNDSFVDPEFMDSVLDNQLTIKGKKQFLDDGEFFTDRNVPQIDEATKMKWASMTSPPQEALNALNEFFGHKGFREKQWDVVRNVLGGKDQFVLMSTGYGKS";let myprot=new Protein(prot);console.log(myprot);export function compute_molecular_weight(aminoAcidComposition){const{MOLECULAR_WEIGHT:mw_table}=AMINO_ACID_DATA;let mw=0,mw_mi=0;for(const a in aminoAcidComposition){mw+=aminoAcidComposition[a]["count"]*mw_table[a][0];mw_mi+=aminoAcidComposition[a]["count"]*mw_table[a][1]}mw+=mw_table["water"][0];mw_mi+=mw_table["water"][1];return[mw,mw_mi]};export function compute_atomic_composition(aminoAcidComposition){const{ATOMIC_COMPOSITION:ATOMIC_COMPOSITION}=AMINO_ACID_DATA;let composition={C:0,H:0,N:0,O:0,S:0,Se:0};for(const a in aminoAcidComposition){for(const e in ATOMIC_COMPOSITION[a]){composition[e]+=aminoAcidComposition[a]["count"]*ATOMIC_COMPOSITION[a][e]}}return composition};export function compute_extinction_coefficient(aminoAcidComposition){const{C:C,W:W,Y:Y}=aminoAcidComposition;const{EXTINCTION_COEFFICIENT:EXTINCTION_COEFFICIENT}=AMINO_ACID_DATA;const e1=W.count+EXTINCTION_COEFFICIENT.W+Y.count*EXTINCTION_COEFFICIENT.Y;const e2=e1+C.count*EXTINCTION_COEFFICIENT.C;return[e1,e2]};export function compute_isoelectric_point(aminoAcidComposition,nTerm,cTerm){let{CHARGE:{POSITIVE_PKAS:POSITIVE_PKAS,NEGATIVE_PKAS:NEGATIVE_PKAS,PKA_C_TERMINAL:PKA_C_TERMINAL,PKA_N_TERMINAL:PKA_N_TERMINAL,CHARGED_AMINO_ACIDS:CHARGED_AMINO_ACIDS}}=AMINO_ACID_DATA;(function _update_pKs_tables(){nTerm in PKA_N_TERMINAL&&(POSITIVE_PKAS["nTerm"]=PKA_N_TERMINAL[nTerm]);cTerm in PKA_C_TERMINAL&&(NEGATIVE_PKAS["cTerm"]=PKA_C_TERMINAL[cTerm])})();const CHARGED_AMINO_ACIDS_count=function select_charged(){let charged={};for(const a of CHARGED_AMINO_ACIDS){charged[a]=aminoAcidComposition[a].count}charged["nTerm"]=1;charged["cTerm"]=1;return charged}();function charge_at_pH(pH){let positive_charge=0;for(const a in POSITIVE_PKAS){const pK=POSITIVE_PKAS[a];const partial_charge=1/(1+10**(pH-pK));positive_charge+=CHARGED_AMINO_ACIDS_count[a]*partial_charge}let negative_charge=0;for(const a in NEGATIVE_PKAS){const pK=NEGATIVE_PKAS[a];const partial_charge=1/(1+10**(pK-pH));negative_charge+=CHARGED_AMINO_ACIDS_count[a]*partial_charge}return positive_charge-negative_charge}function pi(pH=7.775,min=3.55,max=12){const charge=charge_at_pH(pH);if(max-min>1e-4){charge>0&&(min=pH)||(max=pH);return pi((min+max)/2,min,max)}else{return pH}}return pi()};